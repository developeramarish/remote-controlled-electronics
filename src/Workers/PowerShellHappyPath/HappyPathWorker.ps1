$baseUrl = 'https://rceserver.azurewebsites.net'
$owners = @("demo@example.com")

$registerAddressSuffix = '/api/workers/register/'
$getJobAddressSuffix = '/api/workers/WORKER_ID/jobs/1'
$updateJobsAddressSuffix = '/api/workers/WORKER_ID/jobs/JOB_ID/update'
$completeJobAddressSuffix = '/api/workers/WORKER_ID/jobs/JOB_ID/complete'

$jobSuccess = 'Success'
$jobWarning = 'Warning'
$jobFailure = 'Failure'

$global:workerId = ''

function Register() {
    $registrationModel = @{
        name            = 'PS Counter'
        description     = 'PS Worker Example (happy path only)'
        base64Logo = 'data:image/png;base64,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'
        jobDescriptions = @(
            @{
                name           = 'Count';
                description    = @(
                    'Counts in one second intervals. Params:',
                    ' - from [int]',
                    ' - to [int]'
                )
                defaultPayload = @{
                    from = 0;
                    to   = 5;
                }
            }
        )
        owners          = $owners
    }

    Write-Host Registering worker
    $url = $baseUrl + $registerAddressSuffix
    $response = Invoke-WebRequest -Uri $url -Method Post -ContentType 'application/json' -Body ($registrationModel | ConvertTo-Json -Depth 10)
    $global:workerId = $response -replace '"', ''
}

function GetJob() {
    Write-Host Getting jobs
    $url = $baseUrl + $getJobAddressSuffix -replace 'WORKER_ID', $global:workerId
    $response = Invoke-WebRequest -Uri $url

    return $response | ConvertFrom-Json
}

function UpdateJob($job, $payload) {
    Write-Host "Updating job '$($job.jobName)' '$($job.jobId)'"
    $url = $baseUrl + $updateJobsAddressSuffix -replace 'WORKER_ID', $global:workerId -replace 'JOB_ID', $job.jobId
    $_ = Invoke-WebRequest -Uri $url -Method Post -ContentType 'application/json' -Body ($payload | ConvertTo-Json -Depth 10)
}

function CompleteJob($job, $payload) {
    Write-Host "Completing job '$($job.jobName)' '$($job.jobId)'"
    $url = $baseUrl + $completeJobAddressSuffix -replace 'WORKER_ID', $global:workerId -replace 'JOB_ID', $job.jobId
    $_ = Invoke-WebRequest -Uri $url -Method Post -ContentType 'application/json' -Body ($payload | ConvertTo-Json -Depth 10)
}

function FailJob($job, $reason) {
    failPayload = @{
        failure   = $reason
        jobStatus = $jobFailure
    }

    Write-Host "Job failed '$($job.jobName)' '$($job.jobId)'"
    $url = $baseUrl + $completeJobAddressSuffix -replace 'WORKER_ID', $global:workerId -replace 'JOB_ID', $job.jobId
    $_ = Invoke-WebRequest -Uri $url -Method Post -ContentType 'application/json' -Body ($payload | ConvertTo-Json -Depth 10)
}

function RunJob($job) {
    if ($job) {
        switch ($job.jobName) {
            "Count" { CountJob $job; break }
            default { "Job not found"; break }
        }
    }
}

function CountJob($job) {
    $from = $job.payload.from
    $to = $job.payload.to
    for ($i = $from; $i -lt $to; $i++) {
        UpdateJob $job @{
            currentCount = $i
        }
        Start-Sleep 1
    }
    CompleteJob $job @{
        currentCount = $to
        jobStatus    = $jobSuccess
    }
}

Register
while ($true) {
    $job = GetJob
    RunJob $job[0]
}
